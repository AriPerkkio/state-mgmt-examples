(self.webpackChunkstate_mgmt_examples=self.webpackChunkstate_mgmt_examples||[]).push([[571],{2108:function(e,t,n){"use strict";n.d(t,{Tt:function(){return y},ZP:function(){return v},Rf:function(){return b}});var r=n(7757),u=n.n(r),s=n(8926),c=n.n(s),i=n(4575),a=n.n(i),o=n(3913),l=n.n(o),f=n(9713),d=n.n(f),E=n(6967),m=n(7808),h=n.n(m),p=function(){function e(){var t=this;a()(this,e),d()(this,"requests",[]),d()(this,"subscribers",[]),d()(this,"getUsers",(function(){return t._fetch("/users")})),d()(this,"addUser",function(){var e=c()(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addRequest("POST /users"),e.next=3,(0,E.gw)(2e3);case 3:return t.addRequest("OK /users"),e.abrupt("return",{name:n,id:(0,E.EL)()});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"removeUser",function(){var e=c()(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addRequest("DELETE /users/".concat(n.id)),e.next=3,(0,E.gw)(2e3);case 3:t.addRequest("OK /users/".concat(n.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"clearRequests",(function(){t.requests=[],t.notifySubscribers()}))}var t,n;return l()(e,[{key:"_fetch",value:(n=c()(u().mark((function e(t){var n,r,s,i=this,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},r=n.delayMs,s=t.replace(this.baseUrl,""),this.addRequest("GET ".concat(s)),e.abrupt("return",this._mockFetch(t).then((function(e){if(!e.ok)throw new Error("Request to ".concat(t," failed with HTTP").concat(e.status));return e})).then((function(e){return e.json()})).then(function(){var e=c()(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,E.gw)(r||2e3);case 2:return i.addRequest("OK ".concat(s)),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"subscribe",value:function(e){this.subscribers.push(e),e(this.reqests)}},{key:"unSubscribe",value:function(e){this.subscribers=this.subscribers.filter((function(t){return t!==e}))}},{key:"addRequest",value:function(e){this.requests.push(e),this.notifySubscribers()}},{key:"notifySubscribers",value:function(){var e=this;this.subscribers.forEach((function(t){return t(e.requests)}))}},{key:"_mockFetch",value:(t=c()(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h()[t],e.abrupt("return",{ok:!!n,status:n?200:404,json:function(){return new Promise((function(e){return e(n)}))}});case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),R=new p,v=R,b=R.getUsers,O=n(3038),D=n.n(O),_=n(7294),A=n(5049),g=n(3520);function y(){var e=(0,_.useReducer)((function(e){return e+1}),0),t=D()(e,2)[1];(0,_.useEffect)((function(){return v.subscribe(t),function(){v.unSubscribe(t),v.clearRequests()}}),[]);var n=v.requests.length,r=n>10?n-10:0;return _.createElement("section",null,_.createElement(A.H3,{onClick:v.clearRequests,style:{cursor:"pointer"}},"API requests, click to reset"),_.createElement(g.a,null,n>10&&_.createElement(g.H,null,"..."),v.requests.slice(r).map((function(e,t){return _.createElement(g.H,{key:t},e)}))))}},7808:function(e){e.exports={"/users":[{id:1,name:"John Doe"},{id:2,name:"Jane Doe"}]}},1830:function(e,t,n){"use strict";n.d(t,{E:function(){return s}});var r=n(9163),u=n(9848),s=r.ZP.div.withConfig({displayName:"Containers__FlexContainer",componentId:"osdxjy-0"})(["display:flex;& > * + *{margin-left:5rem;border-left:1px dashed ",";padding-left:2rem;}"],u.A2)},3242:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(7154),u=n.n(r),s=n(3038),c=n.n(s),i=n(6479),a=n.n(i),o=n(7294),l=n(9163).ZP.input.withConfig({displayName:"Input__StyledInput",componentId:"tgycnj-0"})(["margin-right:1rem;&[disabled]{text-decoration:line-through;}"]);function f(e){var t=e.children,n=e.disabled,r=a()(e,["children","disabled"]),s=(0,o.useState)(""),i=c()(s,2),f=i[0],d=i[1];return(0,o.useEffect)((function(){!n&&d("")}),[n]),o.createElement("div",null,o.createElement(l,u()({type:"text",disabled:n,value:f,onChange:function(e){return d(e.target.value)}},r)),t(f))}},1162:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(3038),u=n.n(r),s=n(7294),c=n(5109);function i(e){var t=e.initiallyMounted,n=e.children,r=(0,s.useReducer)((function(e){return!e}),!!t),i=u()(r,2),a=i[0],o=i[1];return s.createElement(s.Fragment,null,s.createElement(c.Z,{onClick:o},a?"Unmount":"Mount"),a&&n)}},6967:function(e,t,n){"use strict";n.d(t,{gw:function(){return r},EL:function(){return s},ZT:function(){return c}});var r=function(e){return new Promise((function(t){return setTimeout(t,e)}))},u=10,s=function(){return u++},c=function(){}},2571:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Q}});var r,u,s,c,i,a,o,l,f=n(7294),d=n(9713),E=n.n(d),m=n(629),h=n(375),p="IDLE",R="NOT_LOADED",v="LOADING",b="LOAD_ERROR",O="ADDING",D="ADD_ERROR",_="REMOVING",A="REMOVE_ERROR",g="LOAD",y="LOAD_SUCCESS",S="LOAD_FAILURE",U="ADD",k="ADD_SUCCESS",x="ADD_FAILURE",L="REMOVE",w="REMOVE_SUCCESS",C="REMOVE_FAILURE",q=(0,m.J)({id:"users",initial:R,context:{users:[]},states:(l={},E()(l,R,{on:E()({},g,v)}),E()(l,p,{on:(r={},E()(r,U,O),E()(r,L,_),r)}),E()(l,v,{on:(u={},E()(u,y,{target:p,actions:(0,h.f0)({users:function(e,t){return e.users.concat(t.users)}})}),E()(u,S,b),u)}),E()(l,b,(s={},E()(s,U,O),E()(s,L,_),s)),E()(l,O,{on:(c={},E()(c,k,{target:p,actions:(0,h.f0)({users:function(e,t){return e.users.concat(t.user)}})}),E()(c,x,D),c)}),E()(l,D,(i={},E()(i,U,O),E()(i,L,_),i)),E()(l,_,{on:(a={},E()(a,w,{target:p,actions:(0,h.f0)({users:function(e,t){return e.users.filter((function(e){return e.id!==t.user.id}))}})}),E()(a,C,A),a)}),E()(l,A,(o={},E()(o,U,O),E()(o,L,_),o)),l)}),I=n(3038),F=n.n(I),M=n(7845),Z=n(2108),j=n(2938),N=n(3520),P=n(3242),T=n(5109),V=n(3082),G=O;function H(){(0,V.tc)("UserList");var e,t,n,r,u,s,c,i=(e=(0,M.useMachine)(q),r=(n=(t=F()(e,2))[0]).value,u=n.context,s=t[1],c=r===R,(0,f.useEffect)((function(){c&&(s("LOAD"),Z.ZP.getUsers().then((function(e){return s("LOAD_SUCCESS",{users:e})})).catch((function(){return s("LOAD_FAILURE")})))}),[c,s]),{state:r,users:u.users,add:function(e){s("ADD"),Z.ZP.addUser(e).then((function(e){return s("ADD_SUCCESS",{user:e})})).catch((function(){return s("ADD_FAILURE")}))},remove:function(e){s("REMOVE"),Z.ZP.removeUser(e).then((function(){return s("REMOVE_SUCCESS",{user:e})})).catch((function(){return s("REMOVE_FAILURE")}))}}),a=i.state,o=i.users,l=i.add,d=i.remove;return"LOADING"===a||"NOT_LOADED"===a?f.createElement(j.a,null):"LOAD_ERROR"===a?f.createElement(j.j,null):f.createElement(f.Fragment,null,f.createElement(N.a,null,o.map((function(e){return f.createElement(N.H,{key:e.id,onRemove:function(){return d(e)}},e.name)}))),f.createElement(P.Z,{disabled:a===G},(function(e){return f.createElement(T.Z,{disabled:a===G,onClick:function(){return l(e)}},"Add user")})),"REMOVING"===a&&f.createElement(j.a,null,"Removing user..."),"REMOVE_ERROR"===a&&f.createElement(j.j,null,"Failed to remove user"),a===G&&f.createElement(j.a,null,"Adding user..."),"ADD_ERROR"===a&&f.createElement(j.j,null,"Failed to add user"))}var J=n(5049),K=n(5943),X=n(6406),z=n(1162),B=n(1830);function Q(){return f.createElement(f.Fragment,null,f.createElement(J.H1,null,"Xstate"),f.createElement(T._,null,f.createElement(K.Ou,{text:"machine.js",fileName:"components/xstate/machine.js"}),f.createElement(K.Ou,{text:"useUsers.js",fileName:"components/xstate/useUsers.js"}),f.createElement(K.Ou,{text:"UserList.js",fileName:"components/xstate/UserList.js"})),f.createElement("br",null),f.createElement(z.Z,null,f.createElement(H,null)),f.createElement(B.E,null,f.createElement(X.Z,null),f.createElement(Z.Tt,null)))}}}]);