(self.webpackChunkstate_mgmt_examples=self.webpackChunkstate_mgmt_examples||[]).push([[455],{2108:function(e,t,n){"use strict";n.d(t,{Tt:function(){return _},ZP:function(){return g},Rf:function(){return v}});var r=n(7757),u=n.n(r),s=n(8926),c=n.n(s),i=n(4575),o=n.n(i),a=n(3913),l=n.n(a),f=n(9713),d=n.n(f),p=n(6967),m=n(7808),h=n.n(m),b=function(){function e(){var t=this;o()(this,e),d()(this,"requests",[]),d()(this,"subscribers",[]),d()(this,"getUsers",(function(){return t._fetch("/users")})),d()(this,"addUser",function(){var e=c()(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addRequest("POST /users"),e.next=3,(0,p.gw)(2e3);case 3:return t.addRequest("OK /users"),e.abrupt("return",{name:n,id:(0,p.EL)()});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"removeUser",function(){var e=c()(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addRequest("DELETE /users/".concat(n.id)),e.next=3,(0,p.gw)(2e3);case 3:t.addRequest("OK /users/".concat(n.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"clearRequests",(function(){t.requests=[],t.notifySubscribers()}))}var t,n;return l()(e,[{key:"_fetch",value:(n=c()(u().mark((function e(t){var n,r,s,i=this,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=n.delayMs,s=t.replace(this.baseUrl,""),this.addRequest("GET ".concat(s)),e.abrupt("return",this._mockFetch(t).then((function(e){if(!e.ok)throw new Error("Request to ".concat(t," failed with HTTP").concat(e.status));return e})).then((function(e){return e.json()})).then(function(){var e=c()(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.gw)(r||2e3);case 2:return i.addRequest("OK ".concat(s)),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"subscribe",value:function(e){this.subscribers.push(e),e(this.reqests)}},{key:"unSubscribe",value:function(e){this.subscribers=this.subscribers.filter((function(t){return t!==e}))}},{key:"addRequest",value:function(e){this.requests.push(e),this.notifySubscribers()}},{key:"notifySubscribers",value:function(){var e=this;this.subscribers.forEach((function(t){return t(e.requests)}))}},{key:"_mockFetch",value:(t=c()(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h()[t],e.abrupt("return",{ok:!!n,status:n?200:404,json:function(){return new Promise((function(e){return e(n)}))}});case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),y=new b,g=y,v=y.getUsers,E=n(3038),O=n.n(E),R=n(7294),w=n(5049),j=n(3520);function _(){var e=(0,R.useReducer)((function(e){return e+1}),0),t=O()(e,2)[1];(0,R.useEffect)((function(){return g.subscribe(t),function(){g.unSubscribe(t),g.clearRequests()}}),[]);var n=g.requests.length,r=n>10?n-10:0;return R.createElement("section",null,R.createElement(w.H3,{onClick:g.clearRequests,style:{cursor:"pointer"}},"API requests, click to reset"),R.createElement(j.a,null,n>10&&R.createElement(j.H,null,"..."),g.requests.slice(r).map((function(e,t){return R.createElement(j.H,{key:t},e)}))))}},7808:function(e){e.exports={"/users":[{id:1,name:"John Doe"},{id:2,name:"Jane Doe"}]}},1830:function(e,t,n){"use strict";n.d(t,{E:function(){return s}});var r=n(9163),u=n(9848),s=r.ZP.div.withConfig({displayName:"Containers__FlexContainer",componentId:"osdxjy-0"})(["display:flex;& > * + *{margin-left:5rem;border-left:1px dashed ",";padding-left:2rem;}"],u.A2)},3242:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(7154),u=n.n(r),s=n(3038),c=n.n(s),i=n(6479),o=n.n(i),a=n(7294),l=n(9163).ZP.input.withConfig({displayName:"Input__StyledInput",componentId:"tgycnj-0"})(["margin-right:1rem;&[disabled]{text-decoration:line-through;}"]);function f(e){var t=e.children,n=e.disabled,r=o()(e,["children","disabled"]),s=(0,a.useState)(""),i=c()(s,2),f=i[0],d=i[1];return(0,a.useEffect)((function(){!n&&d("")}),[n]),a.createElement("div",null,a.createElement(l,u()({type:"text",disabled:n,value:f,onChange:function(e){return d(e.target.value)}},r)),t(f))}},1162:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(3038),u=n.n(r),s=n(7294),c=n(5109);function i(e){var t=e.initiallyMounted,n=e.children,r=(0,s.useReducer)((function(e){return!e}),!!t),i=u()(r,2),o=i[0],a=i[1];return s.createElement(s.Fragment,null,s.createElement(c.Z,{onClick:a},o?"Unmount":"Mount"),o&&n)}},6967:function(e,t,n){"use strict";n.d(t,{gw:function(){return r},EL:function(){return s},ZT:function(){return c}});var r=function(e){return new Promise((function(t){return setTimeout(t,e)}))},u=10,s=function(){return u++},c=function(){}},4455:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var r=n(7294),u=n(6479),s=n.n(u),c=n(2938),i=n(3520),o=n(3242),a=n(5109),l=n(9713),f=n.n(l),d=n(3038),p=n.n(d),m=n(2108),h=n(319),b=n.n(h);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={type:"ON_LOAD"},E={type:"ON_SUCCESS"},O={type:"ON_ERROR"},R={type:"ON_ADD_START"},w={type:"ON_ADD_SUCCESS"},j={type:"ON_ADD_ERROR"},_={type:"ON_REMOVE_START"},k={type:"ON_REMOVE_SUCCESS"},P={type:"ON_REMOVE_ERROR"},S={users:[],isLoading:!1,hasLoaded:!1,error:!1,isAdding:!1,errorAdding:!1,isRemoving:!1,errorRemoving:!1};function A(e,t){switch(t.type){case v.type:return g(g({},e),{},{isLoading:!0,hasLoaded:!0});case E.type:return g(g({},e),{},{isLoading:!1,users:t.users});case O.type:return g(g({},e),{},{isLoading:!1,error:!0});case R.type:return g(g({},e),{},{isAdding:!0,errorAdding:!1});case w.type:return g(g({},e),{},{isAdding:!1,users:[].concat(b()(e.users),[t.user])});case j.type:return g(g({},e),{},{isAdding:!1,errorAdding:!0});case _.type:return g(g({},e),{},{isRemoving:!0,errorRemoving:!1});case k.type:return g(g({},e),{},{users:e.users.filter((function(e){return e.id!==t.user.id})),isRemoving:!1});case k:return g(g({},e),{},{isRemoving:!1,errorRemoving:!0});default:return e}}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=n(3082);function U(){(0,D.tc)("UserList");var e=function(){var e=(0,r.useReducer)(A,S),t=p()(e,2),n=t[0],u=t[1];return(0,r.useEffect)((function(){u(v),m.ZP.getUsers().then((function(e){return u(q(q({},E),{},{users:e}))})).catch((function(e){console.error(e),u(O)}))}),[]),q(q({},n),{},{add:function(e){u(R),m.ZP.addUser(e).then((function(e){return u(q(q({},w),{},{user:e}))})).catch((function(){return u(j)}))},remove:function(e){u(_),m.ZP.removeUser(e).then((function(){return u(q(q({},k),{},{user:e}))})).catch((function(){return u(P)}))}})}(),t=e.add,n=e.remove,u=s()(e,["add","remove"]);return u.isLoading||!u.hasLoaded?r.createElement(c.a,null):u.error?r.createElement(c.j,null):r.createElement(r.Fragment,null,r.createElement(i.a,null,u.users.map((function(e){return r.createElement(i.H,{key:e.id,onRemove:function(){return n(e)}},e.name)}))),r.createElement(o.Z,{disabled:u.isAdding},(function(e){return r.createElement(a.Z,{disabled:u.isAdding,onClick:function(){return t(e)}},"Add user")})),u.isRemoving&&r.createElement(c.a,null,"Removing user..."),u.errorRemoving&&r.createElement(c.j,null,"Failed to remove user"),u.isAdding&&r.createElement(c.a,null,"Adding user..."),u.errorAdding&&r.createElement(c.j,null,"Failed to add user"))}var C=n(5049),L=n(5943),N=n(6406),Z=n(1830),T=n(1162);function F(){return r.createElement(r.Fragment,null,r.createElement(C.H1,null,"Local State"),r.createElement(a._,null,r.createElement(L.Ou,{text:"reducer.js",fileName:"components/local-state/reducer.js"}),r.createElement(L.Ou,{text:"useUsers.js",fileName:"components/local-state/useUsers.js"}),r.createElement(L.Ou,{text:"UserList.js",fileName:"components/local-state/UserList.js"})),r.createElement(T.Z,null,r.createElement(U,null)),r.createElement(Z.E,null,r.createElement(N.Z,null),r.createElement(m.Tt,null)))}}}]);