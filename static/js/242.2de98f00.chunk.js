(self.webpackChunkstate_mgmt_examples=self.webpackChunkstate_mgmt_examples||[]).push([[242],{2108:function(e,t,n){"use strict";n.d(t,{Tt:function(){return R},ZP:function(){return b},Rf:function(){return y}});var r=n(7757),u=n.n(r),s=n(8926),c=n.n(s),i=n(4575),a=n.n(i),o=n(3913),l=n.n(o),f=n(9713),d=n.n(f),m=n(6967),h=n(7808),p=n.n(h),E=function(){function e(){var t=this;a()(this,e),d()(this,"requests",[]),d()(this,"subscribers",[]),d()(this,"getUsers",(function(){return t._fetch("/users")})),d()(this,"addUser",function(){var e=c()(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addRequest("POST /users"),e.next=3,(0,m.gw)(2e3);case 3:return t.addRequest("OK /users"),e.abrupt("return",{name:n,id:(0,m.EL)()});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"removeUser",function(){var e=c()(u().mark((function e(n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.addRequest("DELETE /users/".concat(n.id)),e.next=3,(0,m.gw)(2e3);case 3:t.addRequest("OK /users/".concat(n.id));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d()(this,"clearRequests",(function(){t.requests=[],t.notifySubscribers()}))}var t,n;return l()(e,[{key:"_fetch",value:(n=c()(u().mark((function e(t){var n,r,s,i=this,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},r=n.delayMs,s=t.replace(this.baseUrl,""),this.addRequest("GET ".concat(s)),e.abrupt("return",this._mockFetch(t).then((function(e){if(!e.ok)throw new Error("Request to ".concat(t," failed with HTTP").concat(e.status));return e})).then((function(e){return e.json()})).then(function(){var e=c()(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.gw)(r||2e3);case 2:return i.addRequest("OK ".concat(s)),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"subscribe",value:function(e){this.subscribers.push(e),e(this.reqests)}},{key:"unSubscribe",value:function(e){this.subscribers=this.subscribers.filter((function(t){return t!==e}))}},{key:"addRequest",value:function(e){this.requests.push(e),this.notifySubscribers()}},{key:"notifySubscribers",value:function(){var e=this;this.subscribers.forEach((function(t){return t(e.requests)}))}},{key:"_mockFetch",value:(t=c()(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p()[t],e.abrupt("return",{ok:!!n,status:n?200:404,json:function(){return new Promise((function(e){return e(n)}))}});case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),v=new E,b=v,y=v.getUsers,k=n(3038),w=n.n(k),x=n(7294),g=n(5049),q=n(3520);function R(){var e=(0,x.useReducer)((function(e){return e+1}),0),t=w()(e,2)[1];(0,x.useEffect)((function(){return b.subscribe(t),function(){b.unSubscribe(t),b.clearRequests()}}),[]);var n=b.requests.length,r=n>10?n-10:0;return x.createElement("section",null,x.createElement(g.H3,{onClick:b.clearRequests,style:{cursor:"pointer"}},"API requests, click to reset"),x.createElement(q.a,null,n>10&&x.createElement(q.H,null,"..."),b.requests.slice(r).map((function(e,t){return x.createElement(q.H,{key:t},e)}))))}},7808:function(e){e.exports={"/users":[{id:1,name:"John Doe"},{id:2,name:"Jane Doe"}]}},1830:function(e,t,n){"use strict";n.d(t,{E:function(){return s}});var r=n(9163),u=n(9848),s=r.ZP.div.withConfig({displayName:"Containers__FlexContainer",componentId:"osdxjy-0"})(["display:flex;& > * + *{margin-left:5rem;border-left:1px dashed ",";padding-left:2rem;}"],u.A2)},1162:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(3038),u=n.n(r),s=n(7294),c=n(5109);function i(e){var t=e.initiallyMounted,n=e.children,r=(0,s.useReducer)((function(e){return!e}),!!t),i=u()(r,2),a=i[0],o=i[1];return s.createElement(s.Fragment,null,s.createElement(c.Z,{onClick:o},a?"Unmount":"Mount"),a&&n)}},6967:function(e,t,n){"use strict";n.d(t,{gw:function(){return r},EL:function(){return s},ZT:function(){return c}});var r=function(e){return new Promise((function(t){return setTimeout(t,e)}))},u=10,s=function(){return u++},c=function(){}},4242:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var r=n(7294),u=n(3038),s=n.n(u),c=n(7845),i=n(629),a=n(375),o=n(2108),l={context:{users:[]}};var f=n(2938),d=n(3520),m=n(3082);function h(){(0,m.tc)("UserList");var e,t,n,u,h,p,E,v=(e=(0,c.useMachine)(function({context:e={},services:t}={}){return(0,i.C)({initial:"notLoaded",context:e,states:{idle:{},notLoaded:{on:{load:"loading"}},loading:{invoke:{src:"getUsers",onDone:{target:"idle",actions:[(0,a.f0)({users:(e,t)=>t.data})]},onError:"loadError"}},loadError:{}}},{services:{getUsers:o.Rf}})}(l)),t=s()(e,2),n=t[0],u=n.value,h=n.context,p=t[1],E="notLoaded"===u,(0,r.useEffect)((function(){E&&p("load")}),[E,p]),{state:u,users:h.users}),b=v.state,y=v.users;return"loading"===b||"notLoaded"===b?r.createElement(f.a,null):"loadError"===b?r.createElement(f.j,null):r.createElement(d.a,null,y.map((function(e){return r.createElement(d.H,{key:e.id},e.name)})))}var p=n(5049),E=n(5109),v=n(5943),b=n(6406),y=n(1162),k=n(1830);function w(){return r.createElement(r.Fragment,null,r.createElement(p.H1,null,"Lucy"),r.createElement(E._,null,r.createElement(v.Ou,{text:"user-list.lucy",fileName:"components/lucy/user-list.lucy"}),r.createElement(v.Ou,{text:"useUsers.js",fileName:"components/lucy/useUsers.js"}),r.createElement(v.Ou,{text:"UserList.js",fileName:"components/lucy/UserList.js"})),r.createElement("br",null),r.createElement(y.Z,null,r.createElement(h,null)),r.createElement(k.E,null,r.createElement(b.Z,null),r.createElement(o.Tt,null)))}}}]);